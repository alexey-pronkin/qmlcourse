
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ü—Ä–∞–∫—Ç–∏–∫–∞ VQE &#8212; QMLCourse</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://semyonsinchenko.github.io/qmlcourse/_build/html/book/index.html/book/vqeblock/tspvqe.html" />
    <link rel="shortcut icon" href="../../_static/qmlcourse_favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="–û –±–ª–æ–∫–µ ‚ÄúD-Wave ‚Äì –∫–≤–∞–Ω—Ç–æ–≤—ã–π –æ—Ç–∂–∏–≥ –∏ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ‚Äù" href="../dwaveblock/dwaveintro.html" />
    <link rel="prev" title="Variational Quantum Eigensolver" href="vqe.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">QMLCourse</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –í–≤–µ–¥–µ–Ω–∏–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro1block/intro1.html">
   üü¶ –û –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../prerequisite.html">
   ‚¨ú –ü—Ä–µ—Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∫—É—Ä—Å–∞
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û—Å–Ω–æ–≤—ã Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/pythonintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l1.html">
   üü¶ –í–≤–æ–¥–Ω–∞—è –ª–µ–∫—Ü–∏—è –ø—Ä–æ Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l2.html">
   üü¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l3.html">
   üü¶ –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –≤ Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l4.html">
   üü¶ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ç–∏–ø—ã –∏ –≤—ã–≤–æ–¥
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l5.html">
   üü¶ –£—Å–ª–æ–≤–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l6.html">
   üü¶ –°–ø–∏—Å–∫–∏ –∏ —Ü–∏–∫–ª—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l7.html">
   üü¶ –°–ª–æ–≤–∞—Ä–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l8.html">
   üü¶ –§—É–Ω–∫—Ü–∏–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l9.html">
   üü¶ –û–±—ä–µ–∫—Ç—ã –∏ –∫–ª–∞—Å—Å—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l10.html">
   üü¶ –§–∏–Ω–∞–ª—å–Ω–∞—è –ª–µ–∫—Ü–∏—è
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –õ–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞ –∏ numpy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/intro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/vectors.html">
   üü¶ –í–µ–∫—Ç–æ—Ä—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/bra-ket.html">
   üü¶ –ù–æ—Ç–∞—Ü–∏—è –î–∏—Ä–∞–∫–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/matrices.html">
   üü¶ –ú–∞—Ç—Ä–∏—Ü—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/numpy.html">
   üü¶ Numpy fun
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û—Å–Ω–æ–≤—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mlblock/ml_intro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mlblock/ml_l1.html">
   üü¶ –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∫–∞–∫ –ø–∞–∑–ª
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/qcintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/qubit.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–π –±–∏—Ç
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/gates.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≥–µ–π—Ç—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/mixedstates.html">
   üü® –°–º–µ—à–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –§—Ä–µ–π–º–≤–æ—Ä–∫–∏
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/progintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/progreview.html">
   üü© –û–±–∑–æ—Ä —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/pennylane.html">
   üü© PennyLane
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/qiskit.html">
   üüß Qiskit
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ë–∞–∑–æ–≤—ã–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/qcalgointro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/quantum_algorithms_overview.html">
   üü© –û–±–∑–æ—Ä –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/deutschs_algorithm.html">
   üü© –ê–ª–≥–æ—Ä–∏—Ç–º –î–æ–π—á–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/quantum_teleportation.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/grovers_algorithm.html">
   üüß –ê–ª–≥–æ—Ä–∏—Ç–º –ì—Ä–æ–≤–µ—Ä–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/simon_algorithm.html">
   üüß –ê–ª–≥–æ—Ä–∏—Ç–º –°–∞–π–º–æ–Ω–∞
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ñ–µ–ª–µ–∑–æ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../hwblock/hwintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hwblock/hwreview.html">
   üü© –û–±–∑–æ—Ä
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hwblock/scqubits.html">
   üü• –°–≤–µ—Ä—Ö–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–æ–≤—ã–µ –∫—É–±–∏—Ç—ã
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/qmlkindsintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/qmlkinds.html">
   üü¶ –í–∏–¥—ã QML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/hhl_algorithm.html">
   üü• –ê–ª–≥–æ—Ä–∏—Ç–º HHL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/qknn.html">
   üü• –ê–ª–≥–æ—Ä–∏—Ç–º QKNN
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../vqcblock/vqcintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../vqcblock/vqc.html">
   üü© –í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../gradsblock/gradsintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../gradsblock/gradients.html">
   üü© –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Å—Ö–µ–º
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../gradsblock/hogradients.html">
   üüß –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤—ã—Å—à–∏—Ö –ø–æ—Ä—è–¥–∫–æ–≤
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–π SVM
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qsvmblock/qsvmintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qsvmblock/hybridsvm.html">
   üü© –ì–∏–±—Ä–∏–¥–Ω—ã–π SVM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qsvmblock/classic_svm.html">
   üüß –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π SVM
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qnnblock/qnnintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qnnblock/qnn.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qnnblock/qconv.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–µ—Ç–∏
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ü—Ä–æ–±–ª–µ–º—ã –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/problemsintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/quantchembasic.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ö–∏–º–∏—è (–í–≤–µ–¥–µ–Ω–∏–µ)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/quantchemadvancedscf.html">
   üüß –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ö–∏–º–∏—è (SCF)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/ising.html">
   üü© –ú–æ–¥–µ–ª—å –ò–∑–∏–Ω–≥–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/advising.html">
   üüß –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –º–æ–¥–µ–ª—å –ò–∑–∏–Ω–≥–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/copt.html">
   üü© –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û—Ç –ø—Ä–æ–±–ª–µ–º –∫ –æ–±—É—á–µ–Ω–∏—é
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/problems2qmlintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/np2ising.html">
   üü© NP –∫–∞–∫ –º–æ–¥–µ–ª–∏ –ò–∑–∏–Ω–≥–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/jordanwigner.html">
   üüß –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ñ–æ—Ä–¥–∞–Ω–∞-–í–∏–≥–Ω–µ—Ä–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/eigenvals.html">
   üü© –û —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  VQE
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="vqeintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vqe.html">
   üü© –û—Å–Ω–æ–≤—ã VQE
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   üüß VQE - –ø—Ä–∞–∫—Ç–∏–∫–∞
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  D-Wave ‚Äì –∫–≤–∞–Ω—Ç–æ–≤—ã–π –æ—Ç–∂–∏–≥ –∏ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dwaveblock/dwaveintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dwaveblock/dwave.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–π –æ—Ç–∂–∏–≥ –∏ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û –∫—É—Ä—Å–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   –°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../authors.html">
   –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤ –∫—É—Ä—Å–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../acknowledgments.html">
   –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary.html">
   –ì–ª–æ—Å—Å–∞—Ä–∏–π
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../../_sources/book/vqeblock/tspvqe.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/book/vqeblock/tspvqe.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/SemyonSinchenko/qmlcourse"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/SemyonSinchenko/qmlcourse/issues/new?title=Issue%20on%20page%20%2Fbook/vqeblock/tspvqe.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/SemyonSinchenko/qmlcourse/master?urlpath=tree/qmlcourseRU/book/vqeblock/tspvqe.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   –°–ª—É—á–∞–π–Ω—ã–π –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tsp-networkx">
   –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ TSP –≤ NetworkX
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sigma-z-mod">
   –ú–∞—Ç—Ä–∏—Ü–∞
   <span class="math notranslate nohighlight">
    \(\sigma^z_{mod}\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tsp">
   –ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω –∑–∞–¥–∞—á–∏ TSP
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vqe-pennylane">
   VQE –Ω–∞ Pennylane
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   –°–∏–º—É–ª—è—Ü–∏—è
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="vqe">
<span id="tsp2vqe"></span><h1>–ü—Ä–∞–∫—Ç–∏–∫–∞ VQE<a class="headerlink" href="#vqe" title="Permalink to this headline">¬∂</a></h1>
<p>–≠—Ç–∞ –ª–µ–∫—Ü–∏—è –±—É–¥–µ—Ç –ø–æ—Å–≤—è—â–µ–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —Å <strong>VQE</strong>, –∞ –∏–º–µ–Ω–Ω–æ —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞. –ë—É–¥–µ—Ç –º–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ –º–∞–ª–æ —Ç–µ–æ—Ä–∏–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ª–µ–∫—Ü–∏–∏:</p>
<ul class="simple">
<li><p><a class="reference external" href="../problemsblock/copt.html#id7">–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞</a> –≤ –ª–µ–∫—Ü–∏–∏ –ø—Ä–æ –∑–∞–¥–∞—á–∏ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.</p></li>
<li><p><a class="reference external" href="../problems2qml/np2ising.html#id10">–°–≤–µ–¥–µ–Ω–∏–µ —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –∫ –º–æ–¥–µ–ª–∏ –ò–∑–∏–Ω–≥–∞</a> –≤ –ª–µ–∫—Ü–∏–∏ –æ –ø–µ—Ä–µ—Ö–æ–¥–µ –æ—Ç –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω—ã—Ö –∑–∞–¥–∞—á –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º.</p></li>
</ul>
<p>–ù–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä <span class="math notranslate nohighlight">\(\sigma^{z_{mod}}\)</span>, –∫–æ—Ç–æ—Ä—ã–π –∞–∫—Ç–∏–≤–Ω–æ <a class="reference external" href="../problems2qml/np2ising.html#id3">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏</a> –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–∞. –ù—É–∂–Ω–æ –±—É–¥–µ—Ç —Ä–∞—Å–ø–∏—Å–∞—Ç—å –ø–æ–ª–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä, –æ—Ç–≤–µ—á–∞—é—â–∏–π –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ –∏ –Ω—É–∂–µ–Ω —Å–ª—É—á–∞–π–Ω—ã–π –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –±—É–¥–µ—Ç ‚Äú–ø—É—Ç–µ—à–µ—Å—Ç–≤–æ–≤–∞—Ç—å‚Äù –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä. –ù–∞—á–Ω–µ–º —Å –∏–º–ø–æ—Ä—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞.</p>
<div class="section" id="id1">
<h2>–ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫<a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h2>
<p>–î–ª—è –≥—Ä–∞—Ñ–æ–≤ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏–∑ —É–∂–µ –∑–Ω–∞–∫–æ–º–æ–π –Ω–∞–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ <code class="docutils literal notranslate"><span class="pre">NetwrokX</span></code>, –∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ <code class="docutils literal notranslate"><span class="pre">SciPy</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_format</span> <span class="o">=</span> <span class="s2">&quot;retina&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">sl</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>–°–ª—É—á–∞–π–Ω—ã–π –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ<a class="headerlink" href="#id2" title="Permalink to this headline">¬∂</a></h2>
<p>–°–ª—É—á–∞–π–Ω—ã–π –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑ —Å–ª—É—á–∞–π–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤. –î–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º —Ç–∞–∫—É—é:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–¢—É—Ç –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å –º–∞—Ç—Ä–∏—Ü–µ–π –ø–æ–ª–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞, —Ç–æ –µ—Å—Ç—å —Ç–∞–∫–æ–≥–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–∞–∂–¥–æ–π. –≠—Ç–æ –≤–ø–æ–ª–Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –¥–æ–ø—É—â–µ–Ω–∏–µ –¥–ª—è –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞, —Ç–∞–∫ –∫–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –†–§ –æ–±—ã—á–Ω–æ –º–æ–∂–Ω–æ –ø–æ–ø–∞—Å—Ç—å –≤–æ –≤—Å–µ –¥—Ä—É–≥–∏–µ, –ø—É—Å—Ç—å –∏ –∑–∞ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –≤ –ø—É—Ç–∏.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">rand_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>–¢–æ–ª—å–∫–æ —ç—Ç–∞ –º–∞—Ç—Ä–∏—Ü–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π –∏ –∏–º–µ–µ—Ç –Ω–µ–Ω—É–ª–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–∏. –≠–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –æ–∑–Ω–∞—á–∞—é—Ç –ø–µ—Ç–ª–∏ (loop –∏–ª–∏ self-loop), —á—Ç–æ –Ω–µ –æ—á–µ–Ω—å —Ä–∞–∑—É–º–Ω–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞: –Ω–µ —è—Å–Ω–æ, —á—Ç–æ –∑–Ω–∞—á–∏—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—É—Ç—å –∏–∑ –ú–æ—Å–∫–≤—ã –≤ –ú–æ—Å–∫–≤—É. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏ –ø—Ä–æ —Ç–æ, —á—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –Ω–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è: –µ—Å–ª–∏ –ø—É—Ç—å –∏–∑ –ú–æ—Å–∫–≤—ã –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ –∑–∞–π–º–µ—Ç 6 —á–∞—Å–æ–≤, —Ç–æ –∏ –ø—É—Ç—å –æ–±—Ä–∞—Ç–Ω–æ —Ç–æ–∂–µ –∑–∞–π–º–µ—Ç —Å—Ç–æ–ª—å–∫–æ –∂–µ. –¢–∞–∫ —á—Ç–æ —Ö–æ—Ç–∏–º —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É. –î–∞–≤–∞–π—Ç–µ —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏–º:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rand_adj</span> <span class="o">=</span> <span class="p">(</span><span class="n">rand_mat</span> <span class="o">+</span> <span class="n">rand_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">rand_adj</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–ù–∞–∫–æ–Ω–µ—Ü, —Å–¥–µ–ª–∞–µ–º –∏–∑ —ç—Ç–æ–≥–æ –≥—Ä–∞—Ñ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –µ–≥–æ:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">rand_adj</span><span class="p">)</span>

<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">drawing</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">random_layout</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">)</span>
<span class="n">edge_weights</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_weights</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tsp-networkx">
<h2>–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ TSP –≤ NetworkX<a class="headerlink" href="#tsp-networkx" title="Permalink to this headline">¬∂</a></h2>
<p>–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –ø–æ–Ω—è—Ç—å, —á—Ç–æ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–¥–µ–ª–∞–ª–∏, –¥–∞–≤–∞–π—Ç–µ –Ω–∞–π–¥–µ–º –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nx_solution</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">approximation</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NetworkX solution (nodes order): </span><span class="si">{</span><span class="n">nx_solution</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">nx_solution_cost</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nx_solution</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">nx_solution_cost</span> <span class="o">+=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">nx_solution</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nx_solution</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NetworkX solution (total cost): </span><span class="si">{</span><span class="n">nx_solution_cost</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sigma-z-mod">
<h2>–ú–∞—Ç—Ä–∏—Ü–∞ <span class="math notranslate nohighlight">\(\sigma^z_{mod}\)</span><a class="headerlink" href="#sigma-z-mod" title="Permalink to this headline">¬∂</a></h2>
<p>–≠—Ç–æ –±–∏–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π <a class="reference external" href="../problems2qml/np2ising.html#id3">—Ä–∞–Ω–µ–µ –≤–≤–æ–¥–∏–ª–∏</a> –≤ –ª–µ–∫—Ü–∏–∏ –æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω—ã—Ö –∑–∞–¥–∞—á –≤ –≤–∏–¥–µ –º–æ–¥–µ–ª–µ–π –ò–∑–∏–Ω–≥–∞.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sigma_z_mod</span><span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">:</span>
    <span class="n">sz_mod</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,],</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">left_ith</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">k</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;coo&quot;</span><span class="p">)</span>
    <span class="n">right_ith</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;coo&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span>
        <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">left_ith</span><span class="p">,</span> <span class="n">sz_mod</span><span class="p">),</span>
        <span class="n">right_ith</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ —ç—Ç–∞ –º–∞—Ç—Ä–∏—Ü–∞ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è 0 –∏ 1, –≤ —á–µ–º –ª–µ–≥–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è, —Å–æ–∑–¥–∞–≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä –º–∞–ª–µ–Ω—å–∫–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ –≤—ã—á–∏—Å–ª–∏–≤ –≤—Å–µ –µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">sigma_z_mod</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">eigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>–õ–µ–≥–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã <span class="math notranslate nohighlight">\(\sigma^{z_{mod}}\)</span> —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ <span class="math notranslate nohighlight">\(\sigma^z\)</span>, –ø—Ä–∏—á–µ–º –æ–Ω–∏ –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1, –∫–æ–≥–¥–∞ —Å–ø–∏–Ω —Å –Ω–æ–º–µ—Ä–æ–º 2 –∏–º–µ–µ—Ç –≤ –±–∏—Ç–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ –∑–Ω–∞—á–µ–Ω–∏–µ 0 –∏ 1 –µ—Å–ª–∏ –æ–Ω –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1. –ù–∞–ø–æ–º–Ω—é, —á—Ç–æ —É –Ω–∞—Å 0-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è, –ø–æ—ç—Ç–æ–º—É <code class="docutils literal notranslate"><span class="pre">sigma_z_mod(1,</span> <span class="pre">3)</span></code> –∑–Ω–∞—á–∏—Ç —á—Ç–æ-—Ç–æ —Ç–∏–ø–∞ ‚Äú–ø–æ—Å—Ç—Ä–æ–π –º–Ω–µ –º–∞—Ç—Ä–∏—Ü—É <span class="math notranslate nohighlight">\(\sigma^{z_{mod}}\)</span>, –¥–µ–π—Å—Ç–≤—É—é—â—É—é –Ω–∞ –≤—Ç–æ—Ä–æ–π —Å–ø–∏–Ω (–Ω—É –∏–ª–∏ –≤—Ç–æ—Ä–æ–π –∫—É–±–∏—Ç)‚Äù.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sigmaz_k</span><span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">:</span>
    <span class="n">left_part</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">right_part</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">k</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span>
        <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span>
            <span class="n">left_part</span><span class="p">,</span>
            <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,],]))</span>
        <span class="p">),</span>
        <span class="n">right_part</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">probs2bit_str</span><span class="p">(</span><span class="n">probs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">bit_s_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">probs</span> <span class="o">==</span> <span class="n">probs</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bit_s_num</span><span class="si">:</span><span class="s2">b</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">+</span> <span class="n">s</span>

    <span class="k">return</span> <span class="n">s</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">psi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="n">psi</span> <span class="o">*</span> <span class="n">psi</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
    <span class="n">bit_s</span> <span class="o">=</span> <span class="n">probs2bit_str</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eigenvalue: </span><span class="si">{</span><span class="n">eigs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="s2">Bit string: </span><span class="si">{</span><span class="n">bit_s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–£–±–µ–¥–∏–º—Å—è —Ç–∞–∫–∂–µ –≤ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ —Å –º–∞—Ç—Ä–∏—Ü–µ–π <span class="math notranslate nohighlight">\(\sigma^z\)</span>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–î–ª—è —á–∏—Å—Ç—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –±–µ–∑ –∑–∞–ø—É—Ç—ã–≤–∞–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –≤–∏–¥—É –µ–¥–∏–Ω–∏—á–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü. –ò –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –∫–∞–∂–¥—ã–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç —Å—Ç—Ä–æ–≥–æ –æ–¥–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–ø–∏–Ω–æ–≤, –∞ –∑–Ω–∞—á–∏—Ç –µ–≥–æ –≤–æ–ª–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–º–µ–µ—Ç –≤–∏–¥ <span class="math notranslate nohighlight">\(\ket{\Psi} = \ket{0, 0, ..., 1, ..., 0, 0}\)</span>, –≥–¥–µ 1 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–∞–∫ —Ä–∞–∑ –Ω–æ–º–µ—Ä—É —Ç–æ–π –±–∏—Ç–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç —ç—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sigma z_mod:</span><span class="se">\n</span><span class="si">{</span><span class="n">eigs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sigma z:</span><span class="se">\n</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">sigmaz_k</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–í –æ–±—â–µ–º —Å–ª—É—á–∞–µ, –¥–∞–∂–µ –µ—Å–ª–∏ —É –¥–≤—É—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞, —Ç–æ –∏—Ö –ø–æ—Ä—è–¥–æ–∫ (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π) —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å–æ–≤—Å–µ–º –Ω–µ –æ–±—è–∑–∞–Ω. –í —ç—Ç–æ–º –ª–µ–≥–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ <span class="math notranslate nohighlight">\(\hat{1}\)</span> –∏ <span class="math notranslate nohighlight">\(\hat{\sigma^z}\)</span> –≤ <span class="math notranslate nohighlight">\(\sigma^{z_{mod}}\)</span>. –ü–æ—ç—Ç–æ–º—É, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –≤ –±—É–¥—É—â–µ–º, –ª—É—á—à–µ –Ω–µ –ø—Ä–∏–≤—ã–∫–∞—Ç—å —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø—Ä–∏ –ø–æ–º–æ—â–∏ <code class="docutils literal notranslate"><span class="pre">np.allclose</span></code>, –∞ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∏—Ö –≥–ª–∞–∑–∞–º–∏ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ.</p>
</div>
</div>
<div class="section" id="tsp">
<h2>–ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω –∑–∞–¥–∞—á–∏ TSP<a class="headerlink" href="#tsp" title="Permalink to this headline">¬∂</a></h2>
<p>–î–∞–≤–∞–π—Ç–µ –µ—â–µ —Ä–∞–∑ –≤—ã–ø–∏—à–µ–º –ø–æ–ª–Ω—ã–π –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω —Å–∏—Å—Ç–µ–º—ã. –ù–∞–ø–æ–º–Ω—é, —á—Ç–æ –∑–∞–¥–∞—á–∞ –±—É–¥–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ <span class="math notranslate nohighlight">\(N^2\)</span> –∫—É–±–∏—Ç, –∫–æ—Ç–æ—Ä—ã–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤—ã—Å—Ç—Ä–æ–µ–Ω—ã –≤ –≤–∏–¥–µ –º–∞—Ç—Ä–∏—Ü—ã, –≥–¥–µ <span class="math notranslate nohighlight">\(i\)</span>-—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <span class="math notranslate nohighlight">\(i\)</span>-–º—É —à–∞–≥—É –≤ —Ü–∏–∫–ª–µ –ø–æ –≥—Ä–∞—Ñ—É, –∞ <span class="math notranslate nohighlight">\(j\)</span>-–π —ç–ª–µ–º–µ–Ω—Ç —Å—Ç—Ä–æ–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–º–µ—Ä—É –≤–µ—Ä—à–∏–Ω—ã –∏ —è–≤–ª—è–µ—Ç—Å—è –±–∏–Ω–∞—Ä–Ω—ã–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º:</p>
<div class="math notranslate nohighlight">
\[
\hat{H} = a\sum_{i=1}^N (1 - \sum_{j=1}^N \sigma^{z_{mod}}_{i,j})^2 + a\sum_{j=1}^N (1 - \sum_{i=1}^N \sigma^{z_{mod}}_{i,j})^2 + a \sum_{u,v \not\in E}\sum_{j=1}^{N-1}\sigma^{z_{mod}}_{u,j}\sigma^{z_{mod}}_{v,j+1} + b \sum_{u,v \in E}\sum_{j=1}^{N-1}\sigma^{z_{mod}}_{u,j}\sigma^{z_{mod}}_{v,j+1}
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–ï—â–µ —Ä–∞–∑ –≤—Å–ø–æ–º–Ω–∏–º, —á—Ç–æ –ø–µ—Ä–≤—ã–µ –¥–≤–∞ —Å–ª–∞–≥–∞–µ–º—ã—Ö ‚Äú–≥–æ–≤–æ—Ä—è—Ç‚Äù: –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤—Ö–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü, –∞ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –≤–µ—Ä—à–∏–Ω—É. –¢—Ä–µ—Ç—å–µ —Å–ª–∞–≥–∞–µ–º–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —à—Ç—Ä–∞—Ñ –∑–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω, –º–µ–∂–¥—É –∫–æ—Ç–æ—Ä—ã–º–∏ –Ω–µ—Ç —Ä–µ–±—Ä–∞, –∞ —á–µ—Ç–≤–µ—Ä—Ç–æ–µ –¥–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—Å–µ–≥–æ –ø—É—Ç–∏. –ü–µ—Ä–≤—ã–µ —Ç—Ä–∏ —Å–ª–∞–≥–∞–µ–º—ã—Ö –∏–¥—É—Ç —Å –±–û–ª—å—à–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º, —á–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–º –≤–∞–∂–Ω–æ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç—å —Å–∞–º–æ–µ –¥–µ—à–µ–≤–æ–µ.</p>
</div>
<p>–°–¥–µ–ª–∞–µ–º —Ñ–∏–Ω—Ç —É—à–∞–º–∏: –±—É–¥–µ–º –≤—Å–µ–≥–¥–∞ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –ø—É—Ç—å –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤ –≤–µ—Ä—à–∏–Ω–µ —Å –∏–Ω–¥–µ–∫—Å–æ–º 0. –¢–∞–∫ –∫–∞–∫ –ø—É—Ç—å –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞ —ç—Ç–æ –≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ —Ü–∏–∫–ª, —Ç–æ –¥–µ–ª–∞–µ–º —ç—Ç–æ —É–ø—Ä–æ—â–µ–Ω–∏–µ –±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –ø–æ—Ç–µ—Ä–∏ –æ–±—â–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –≤–µ—Ä—à–∏–Ω–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º 0 –≤—Å–µ —Ä–∞–≤–Ω–æ –¥–æ–ª–∂–Ω–∞ –±—É–¥–µ—Ç –≤–æ–π—Ç–∏ –≤ –ø—É—Ç—å. –ü—Ä–∏ —ç—Ç–æ–º —Ç–∞–∫–æ–π —Ö–∏—Ç—Ä—ã–π —Ç—Ä—é–∫ –ø–æ–∑–≤–æ–ª–∏—Ç —Å–Ω–∏–∑–∏—Ç—å —á–∏—Å–ª–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫—É–±–∏—Ç —Å <span class="math notranslate nohighlight">\(N^2\)</span> –¥–æ <span class="math notranslate nohighlight">\((N - 1)^2\)</span>, —á—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ (—Ö–æ—Ç—è –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–∫–æ–π –∂–µ). –†–∞–±–æ—Ç–∞—Ç—å —Å –≥—Ä–∞—Ñ–æ–º –±—É–¥–µ–º –ø—Ä–∏ –ø–æ–º–æ—â–∏ —É–∂–µ –∑–Ω–∞–∫–æ–º–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_tsp_to_ising</span><span class="p">(</span><span class="n">g</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">:</span>
    <span class="c1"># –ò–º–µ–µ—Ç—Å—è –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–∞:</span>
    <span class="c1">#  - —á–∞—Å—Ç—å, –¥–∞—é—â–∞—è –Ω–∞–º –ì–∞–º–∏–ª—Ç–æ–Ω–æ–≤ —Ü–∏–∫–ª</span>
    <span class="c1">#  - —á–∞—Å—Ç—å, —Å—á–∏—Ç–∞—é—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—É—Ç–∏</span>
    <span class="c1"># –î–ª—è –Ω–∞—Å –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –≤–µ—Å –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏ –ø—Ä–µ–≤–∞–ª–∏—Ä–≤–∞–ª.</span>
    <span class="c1"># –ü–æ—ç—Ç–æ–º—É, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –±–µ—Ä–µ–º</span>
    <span class="c1"># –ø—è—Ç–∏–∫—Ä–∞—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞ —Ä–µ–±–µ—Ä –≤ –≥—Ä–∞—Ñ–µ.</span>

    <span class="n">a</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="nb">max</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">((</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

    <span class="c1"># –í—ã—á–∏—Å–ª—è–µ–º —Å—É–º–º—É –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º:</span>
    <span class="c1">#   - –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –∫–∞–∂–¥–æ–π –∫–æ–ª–æ–Ω–∫–µ —Å—Ç—Ä–æ–≥–æ –æ–¥–∏–Ω —Ä–∞–∑</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="c1"># –°—á–∏—Ç–∞–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ 1 - sum</span>
        <span class="n">col_sum</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;coo&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">col_sum</span> <span class="o">-=</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># –í–æ–∑–≤–æ–¥–∏–º –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –≥–∞–º–∏–ª—Ç–æ–Ω–∏–∞–Ω—É</span>
        <span class="n">H</span> <span class="o">+=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">col_sum</span> <span class="o">*</span> <span class="n">col_sum</span>

    <span class="c1"># –í—ã—á–∏—Å–ª—è–µ–º —Å—É–º–º—É –ø–æ —Å—Ç—Ä–æ–∫–∞–º:</span>
    <span class="c1">#   - –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ —Å—Ç—Ä–æ–≥–æ –æ–¥–∏–Ω —Ä–∞–∑</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">row_sum</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;coo&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">row_sum</span> <span class="o">-=</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ–º</span>
        <span class="n">H</span> <span class="o">+=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">row_sum</span> <span class="o">*</span> <span class="n">row_sum</span>

    <span class="c1"># –°—á–∏—Ç–∞–µ–º —Å—É–º–º—É –ø–æ —Ç–µ–º —Ä–µ–±—Ä–∞–º, –∫–æ—Ç–æ—Ä—ã—Ö –≤ –≥—Ä–∞—Ñ–µ –Ω–µ—Ç –∏ —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># –°—É–º–º–∞ –ø–æ –≤—Å–µ–º —Ä–µ–±—Ä–∞–º –≥—Ä–∞—Ñ–∞</span>
                <span class="n">coef</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># –°—É–º–º–∞ –ø–æ –≤—Å–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º —Ä–µ–±—Ä–∞–º –≥—Ä–∞—Ñ–∞</span>
                <span class="n">coef</span> <span class="o">=</span> <span class="n">a</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># –î–∞–ª—å—à–µ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏ —Å—á–∏—Ç–∞–µ–º —Å—É–º–º—É</span>
                <span class="n">H</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="n">coef</span>
                    <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="n">H</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">coef</span>
                <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># –ù–∞—á–∏–Ω–∞–µ–º –≤—Å–µ–≥–¥–∞ –∏–∑ –Ω—É–ª–µ–≤–æ–π –≤–µ—Ä—à–∏–Ω—ã, —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–Ω–∏–∑–∏—Ç—å —á–∏—Å–ª–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫—É–±–∏—Ç–æ–≤.</span>
    <span class="c1"># –¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω—ã –¥–æ–±–∞–≤–∏—Ç—å –≤ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω —Å–ª–∞–≥–∞–µ–º–æ–µ, –æ—Ç–≤–µ—á–∞—é—â–µ–µ –∑–∞ –Ω—É–ª–µ–≤—É—é –≤–µ—Ä—à–∏–Ω—É –≤ –ø—É—Ç–∏.</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="n">a</span>

        <span class="n">H</span> <span class="o">+=</span> <span class="n">coef</span> <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">H</span> <span class="o">+=</span> <span class="n">coef</span> <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># PennyLane —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–∞—Ç—Ä–∏—Ü–∞–º–∏ —Ç–æ–ª—å–∫–æ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –ø–æ—ç—Ç–æ–º—É —Å—Ä–∞–∑—É –¥–µ–ª–∞–µ–º –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ.</span>
    <span class="k">return</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Ç–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–∞—Å—Ç —Ç–æ—Ç –∂–µ –ø—É—Ç—å (—Å —Ç–æ–π –∂–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é), —á—Ç–æ –∏ —Ä–µ—à–µ–Ω–∏–µ –∏–∑ <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">op</span> <span class="o">=</span> <span class="n">convert_tsp_to_ising</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">scipy_solution</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">eigs</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;SR&quot;</span><span class="p">,</span> <span class="n">return_eigenvectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ground state energy: </span><span class="si">{</span><span class="n">scipy_solution</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">probs</span> <span class="o">=</span> <span class="n">scipy_solution</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">scipy_solution</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
<span class="n">bit_s</span> <span class="o">=</span> <span class="n">probs2bit_str</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

<span class="c1"># –ù—É–ª–µ–≤–∞—è –≤–µ—Ä—à–∏–Ω–∞ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤–∞—è</span>
<span class="n">scipy_path</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bit_s</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">scipy_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">scipy_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">scipy_solution_cost</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scipy_path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">scipy_solution_cost</span> <span class="o">+=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">scipy_path</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">scipy_path</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SciPy solution (nodes order): </span><span class="si">{</span><span class="n">scipy_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SciPy solution (total cost): </span><span class="si">{</span><span class="n">scipy_solution_cost</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–í–∏–¥–∏–º, —á—Ç–æ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–∞—Ç—Ä–∏—Ü—É —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –≤—ã–¥–∞–ª <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code> (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –∏–Ω–≤–µ—Ä—Å–∏–∏: <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">2,</span> <span class="pre">1,</span> <span class="pre">3,</span> <span class="pre">0]</span></code> –∏ <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">0]</span></code>), –∫–∞–∫ –∏ –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—É—Ç–∏. –≠–Ω–µ—Ä–≥–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –ø–æ –ø—Ä–∏—á–∏–Ω–µ —Ç–æ–≥–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∏ –º–∞–≥–∏—é —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏. –ù–æ —ç—Ç–æ –Ω–µ —Ç–∞–∫ –≤–∞–∂–Ω–æ: –ø–æ —ç–Ω–µ—Ä–≥–∏—è–º –≤–∞–∂–Ω–æ –ª–∏—à—å –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –∑–Ω–∞—è –±–∏—Ç–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—É—Ç–∏ –∑–∞ –ª–∏–Ω–µ–π–Ω–æ–µ –≤—Ä–µ–º—è!</p>
<p>–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ, –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ —Å–∏–º—É–ª—è—Ü–∏–∏ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π!</p>
</div>
<div class="section" id="vqe-pennylane">
<h2>VQE –Ω–∞ Pennylane<a class="headerlink" href="#vqe-pennylane" title="Permalink to this headline">¬∂</a></h2>
<p>–î–ª—è –Ω–∞—á–∞–ª–∞ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–∞—Ç—Ä–∏—Ü—É –∫ —Ç–æ–º—É –æ–±—ä–µ–∫—Ç—É, —Å –∫–æ—Ç–æ—Ä—ã–º —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–≤–∞–Ω—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">Pennylane</span></code> –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç—É —Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–æ–≤ –≤ –≤–∏–¥–µ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã—Ö –ü–∞—É–ª–∏-—Å—Ç—Ä–æ–∫, –Ω–æ —Ç—É—Ç –Ω–µ –±—É–¥–µ–º –µ—â–µ —Ä–∞–∑ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤–µ—Å—å –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω, –∞ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ä–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É.</p>
</div>
<p>–í–µ—Å–∞ –≥—Ä–∞—Ñ–∞ –∏–º–µ—é—Ç —Ä–∞–∑–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏–π –æ—Ç 0 –¥–æ 100. –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ, –ø—Ä–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö –º–æ–∂–µ–º –ø–æ–ª—É—á–∞—Ç—å –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–∞, –≤–ø–ª–æ—Ç—å –¥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç—ã—Å—è—á. –≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ –º–µ—Ç–æ–¥–æ–º <code class="docutils literal notranslate"><span class="pre">paramter-shift</span></code>, –ø–æ—ç—Ç–æ–º—É –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –¥–∞–≤–∞–π—Ç–µ —É–º–Ω–æ–∂–∏–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–µ—Å–æ–≤ –Ω–∞ <span class="math notranslate nohighlight">\(0.1\)</span>. –≠—Ç–æ —Å–¥–µ–ª–∞–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –Ω–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º–∏ –∏ —É–ª—É—á—à–∏—Ç —á–∏—Å–ª–µ–Ω–Ω—É—é —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å. –î–µ–ª–∞—Ç—å —ç—Ç–æ –º–æ–∂–Ω–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ —á–∏—Å–ª–µ–Ω–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ, –∞ –≤–∞–∂–Ω–æ –ª–∏—à—å –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>

<span class="n">numer_stability_const</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">SparseHamiltonian</span><span class="p">(</span><span class="n">op</span> <span class="o">*</span> <span class="n">numer_stability_const</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>–î–∞–ª–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å <em>ansatz</em>. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –æ–±—ã—á–Ω–æ –∏–º–µ—é—Ç –≤–∏–¥ —Ä–µ—à–µ—Ç–∫–∏, —Ç–∏–ø–∞ —Ç–∞–∫–æ–≥–æ:</p>
<div class="figure align-default" id="sycamore-lattice">
<a class="reference internal image-reference" href="../../_images/sycamore.png"><img alt="../../_images/sycamore.png" src="../../_images/sycamore.png" style="width: 350px;" /></a>
<p class="caption"><span class="caption-number">Fig. 127 </span><span class="caption-text">–°—Ö–µ–º–∞—Ç–∏—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ <em>Sycamore</em> –æ—Ç –∫–æ–º–ø–∞–Ω–∏–∏ <em>Google</em> <span id="id3">[<a class="reference internal" href="../bibliography.html#id62"><span>AAB+19</span></a>]</span></span><a class="headerlink" href="#sycamore-lattice" title="Permalink to this image">¬∂</a></p>
</div>
<p>–ü–æ—ç—Ç–æ–º—É, –≤ –∏–¥–µ–∞–ª–µ, —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã –¥–µ–ª–∞—Ç—å –ª–∏–±–æ –æ–¥–Ω–æ–∫—É–±–∏—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –ª–∏–±–æ –¥–≤—É—Ö–∫—É–±–∏—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –Ω–æ –Ω–∞–¥ ‚Äú—Å–æ—Å–µ–¥–Ω–∏–º–∏‚Äù –∫—É–±–∏—Ç–∞–º–∏. –¢–∞–∫ –ø–æ—è–≤–∏–ª–∞—Å—å –∏–¥–µ—è <em>hardware efficient ansatz</em> <span id="id4">[<a class="reference internal" href="../bibliography.html#id31"><span>KMT+17</span></a>]</span>. –û–Ω –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ ‚Äú—Å–ª–æ–µ–≤‚Äù <strong>VQC</strong>, –≥–¥–µ –∫–∞–∂–¥—ã–π —Ç–∞–∫–æ–π —Å–ª–æ–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤—Ä–∞—â–µ–Ω–∏–π, –∞ —Ç–∞–∫–∂–µ –ø–æ–ø–∞—Ä–Ω—ã–µ ‚Äú–∑–∞–ø—É—Ç—ã–≤–∞—é—â–∏–µ‚Äù –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, <a class="reference external" href="../qcblock/gates.html#cy-cz"><em>CZ</em></a>, –∏–ª–∏ –≥–µ–π—Ç <a class="reference external" href="../qcblock/gates.html#cnot-cx"><em>CNOT</em></a>). –í—ã–≥–ª—è–¥–∏—Ç —ç—Ç–æ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:</p>
<div class="figure align-default" id="id8">
<a class="reference internal image-reference" href="../../_images/HWA.png"><img alt="../../_images/HWA.png" src="../../_images/HWA.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 128 </span><span class="caption-text">–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è <em>hardware efficient ansatz</em> (<em>HWEA</em>) –∏–∑ <span id="id5">[<a class="reference internal" href="../bibliography.html#id31"><span>KMT+17</span></a>]</span></span><a class="headerlink" href="#id8" title="Permalink to this image">¬∂</a></p>
</div>
<p>–î–∞–≤–∞–π—Ç–µ —Ä–µ–∞–ª–∏–∑—É–µ–º —Ç–∞–∫–æ–π —Å–ª–æ–π:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ham</span><span class="o">.</span><span class="n">wires</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">layer</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>–ó–¥–µ—Å—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ–º –æ—Å–Ω–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Å—Ö–µ–º. –î–ª—è —Ç–µ—Ö, –∫—Ç–æ –∑–∞–±—ã–ª, —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ <a class="reference internal" href="../vqcblock/vqc.html#vqc"><span class="std std-ref">–æ—Ç–¥–µ–ª—å–Ω–æ–π –ª–µ–∫—Ü–∏–∏</span></a> –ø–æ —ç—Ç–æ–π —Ç–µ–º–µ.</p>
<p>–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –∫–≤–∞–Ω—Ç–æ–≤—ã–º —Å–∏–º—É–ª—è—Ç–æ—Ä–æ–º, –∞ —Ç–∞–∫–∂–µ –Ω–∞–ø–∏—à–µ–º –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è. –¢–∞–∫–æ–π –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ <em>HWEA</em> —Å–ª–æ–µ–≤, –ø–æ—Å–ª–µ —á–µ–≥–æ –∏–∑–º–µ—Ä–∏—Ç—å –æ–∂–∏–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–∞ –≤ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="n">num_layers</span> <span class="o">=</span> <span class="mi">3</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">diff_method</span><span class="o">=</span><span class="s2">&quot;parameter-shift&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">feed_forward</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">size</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">layer</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">qml</span><span class="o">.</span><span class="n">expval</span><span class="p">(</span><span class="n">ham</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–¢–µ–ø–µ—Ä—å –Ω–∞–¥–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –≤—ã–±—Ä–∞—Ç—å –º–µ—Ç–æ–¥ –∏—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –í —ç—Ç–æ—Ç —Ä–∞–∑ –¥–∞–≤–∞–π—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º <code class="docutils literal notranslate"><span class="pre">Momentum</span></code>, —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–º ‚Äú—É—Å–∫–æ—Ä–µ–Ω–Ω—ã–º‚Äù –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–º —Å–ø—É—Å–∫–æ–º:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">MomentumOptimizer</span><span class="p">()</span>
<span class="n">params</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
    <span class="nb">tuple</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–ù—É –∏ –Ω–∞–∫–æ–Ω–µ—Ü –º–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –í—Å–µ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–∂–µ, –∫–∞–∫ –≤ <a class="reference internal" href="../gradsblock/gradients.html#gradients"><span class="std std-ref">–±–∞–∑–æ–≤–æ–π –ª–µ–∫—Ü–∏–∏ –ø—Ä–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã</span></a>. –¢–æ –µ—Å—Ç—å –Ω–∏—á–µ–≥–æ –Ω–æ–≤–æ–≥–æ —Ç—É—Ç –ø–æ —Å—É—Ç–∏ –Ω–µ –¥–µ–ª–∞–µ—Ç—Å—è.</p>
</div>
<div class="section" id="id6">
<h2>–°–∏–º—É–ª—è—Ü–∏—è<a class="headerlink" href="#id6" title="Permalink to this headline">¬∂</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>–û—Å—Ç–æ—Ä–æ–∂–Ω–æ, —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç, —Ç–∞–∫ –∫–∞–∫ –æ–±—É—á–∞–µ–º –¥–æ–≤–æ–ª—å–Ω–æ —Ç—è–∂–µ–ª—É—é —Å—Ö–µ–º—É –Ω–∞ 9-–∏ –∫—É–±–∏—Ç–∞—Ö! –ö—Å—Ç–∞—Ç–∏, –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∏—Ç—å—Å—è –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–æ —ç–Ω–µ—Ä–≥–∏–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–æ—á–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è. –î–ª—è —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–∏—Å–ª–æ —ç–ø–æ—Ö <span class="math notranslate nohighlight">\(\sim 150\)</span>. –ù–æ –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ—Ç –∫–æ–¥ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –¥–∞–Ω–Ω—ã—Ö –ª–µ–∫—Ü–∏–π, —Ç–æ –º—ã –Ω–µ –º–æ–∂–µ–º —Å–µ–±–µ –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å—á–∏—Ç–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ 7-10 –º–∏–Ω—É—Ç. –ß–∏—Ç–∞—Ç–µ–ª—é —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–æ —á–∏—Å–ª–æ —ç–ø–æ—Ö, –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –≤ 3-–º –∑–Ω–∞–∫–µ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">energy</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">feed_forward</span><span class="p">(</span><span class="n">params</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">85</span><span class="p">):</span>
    <span class="n">params</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">step_and_cost</span><span class="p">(</span><span class="n">feed_forward</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="se">\t</span><span class="s2">energy: </span><span class="si">{</span><span class="n">e</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">energy</span><span class="p">)),</span> <span class="n">energy</span><span class="p">,</span> <span class="s2">&quot;.-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Energy by epochs&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">scipy_solution</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">numer_stability_const</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">energy</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Epoch&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>–í–∏–¥–∏–º, —á—Ç–æ <strong>VQE</strong> –æ—Ç–ª–∏—á–Ω–æ —Å—Ö–æ–¥–∏—Ç—Å—è –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é, –∫–æ—Ç–æ—Ä–æ–µ –∑–Ω–∞–µ–º –∏–∑ <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> –∏ <code class="docutils literal notranslate"><span class="pre">ARPACK</span></code>. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–≤–∞–Ω—Ç–æ–≤—ã–π –ø—É—Ç—å —Å–æ–≤–ø–∞–¥–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ –∏–∑ <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –±–∏—Ç–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫. –ù–∞ —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ—Ä—è—è –º–Ω–æ–≥–æ —Ä–∞–∑, –Ω–æ –Ω–∞ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ —Å—Ä–∞–∑—É –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">diff_method</span><span class="o">=</span><span class="s2">&quot;parameter-shift&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">answer</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">size</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span><span class="p">):</span>
        <span class="n">layer</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">qml</span><span class="o">.</span><span class="n">probs</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)))</span>

<span class="n">probs</span> <span class="o">=</span> <span class="n">answer</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">bit_s</span> <span class="o">=</span> <span class="n">probs2bit_str</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

<span class="c1"># –ù—É–ª–µ–≤–∞—è –≤–µ—Ä—à–∏–Ω–∞ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤–∞—è</span>
<span class="n">q_path</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bit_s</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">q_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">q_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">q_solution_cost</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q_path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">q_solution_cost</span> <span class="o">+=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">q_path</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">q_path</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quantum solution (nodes order): </span><span class="si">{</span><span class="n">q_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quantum solution (total cost): </span><span class="si">{</span><span class="n">q_solution_cost</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–£—Ä–∞, –ø–æ–ª—É—á–∏–ª—Å—è —Ç–æ—Ç –∂–µ –æ—Ç–≤–µ—Ç, —á—Ç–æ –∏ –≤ <code class="docutils literal notranslate"><span class="pre">SciPy</span></code>/<code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>. –ó–Ω–∞—á–∏—Ç —Å–∞–º–æ–ø–∏—Å–Ω—ã–π <strong>VQE</strong> —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ.</p>
</div>
<div class="section" id="id7">
<h2>–ó–∞–∫–ª—é—á–µ–Ω–∏–µ<a class="headerlink" href="#id7" title="Permalink to this headline">¬∂</a></h2>
<p>–í —ç—Ç–æ–π –ª–µ–∫—Ü–∏–∏ –ø–æ–ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞–ª–∏—Å—å –≤ —Ä–µ—à–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ <strong>VQE</strong>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./book/vqeblock"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="vqe.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Variational Quantum Eigensolver</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../dwaveblock/dwaveintro.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">–û –±–ª–æ–∫–µ ‚ÄúD-Wave ‚Äì –∫–≤–∞–Ω—Ç–æ–≤—ã–π –æ—Ç–∂–∏–≥ –∏ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ‚Äù</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ODS Quantum Community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-51362752-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>